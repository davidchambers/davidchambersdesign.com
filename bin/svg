#!/usr/bin/env coffee

lores = require '../lib/lo-res/src/lo-res'

xml = '''
<?xml version='1.0' standalone='no'?>
<!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN'
  'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'>
<svg xmlns='http://www.w3.org/2000/svg' version='1.1'
'''
for key, value of require process.argv[2]
  switch key
    when 'defs'  then defs = value
    when 'paths' then paths = value[..]
    else xml += " #{key}='#{value}'"
xml += '>\n'

xml += "<defs>\n#{defs}\n</defs>\n" if defs

offset = 0
for path in paths
  xml += '  <path'
  for key, value of path
    if key is 'lo-res'
      key = 'd'
      value = "M #{offset},0 #{actions = lores value}"
      offset += lores.width(actions) + 5
      xml += " fill-rule='evenodd'"
    xml += " #{key}='#{value}'"
  xml += ' />\n'

xml += '</svg>'

console.log xml
