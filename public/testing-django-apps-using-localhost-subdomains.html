<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Testing Django apps using localhost subdomains</title>
    <link rel="alternate" type="application/atom+xml" href="/feed/" />
    <link rel="stylesheet" href="/css/reset.css" media="all" />
    <link rel="stylesheet" href="/css/print.css" media="print" />
    <link rel="stylesheet" href="/css/screen.css" media="screen" />
    <link rel="shortcut icon" type="image/x-icon" href="http://static.davidchambersdesign.com/favicon.ico" />
    <script src="http://use.typekit.com/jhk0ogh.js"></script>
    <script>try{Typekit.load();}catch(e){}</script>
  </head>
  <body>
    <div id="skip">
      <a href="#main">Skip to main content</a>
    </div>
    <div id="wrap">
      <div id="header">
        <header>
          <a id="title" href="/">David Chambers Design</a>
          <hr />
          <p>It's where I share interesting info with other web geeks</p>
          <nav id="nav">
            <ul>
              <li><a href="/about/"><span><strong>About.</strong> Who I am and what I do.</span></a></li>
              <li><a href="/contact/"><span><strong>Contact.</strong> Just in case you want to get in touch.</span></a></li>
              <li><a href="/archives/"><span><strong>Archives.</strong> Old posts, recent posts, they're all here.</span></a></li>
              <li><a href="/tags/"><span><strong>Tags.</strong> Helpful if you're after posts on a particular topic.</span></a></li>
              <li><a href="https://bitbucket.org/davidchambers"><span><strong>Bitbucket.</strong> Home to most of my open-source projects.</span></a></li>
              <li><a href="/twitter/"><span><strong>Twitter.</strong> It's where I chirrup… or chirp… or something.</span></a></li>
            </ul>
          </nav>
        </header>
      </div>
      <div id="main">
        <article>
          <header>
            <h1>Testing Django apps using localhost subdomains</h1>
            <time datetime="2010-07-04T08:23:00+12:00" pubdate="pubdate">4 July 2010</time>
          </header>
          <p>This turned out to be quite a bit easier than I'd imagined. Here are the things I did:</p>
          <ol>
            <li><p>I saved <a href="http://thingsilearned.com/2009/01/05/using-subdomains-in-django/">Dave Fowler's subdomain middleware</a> as <code>middleware.py</code> in my project directory:</p><pre><code>class SubdomainMiddleware:
def process_request(self, request):
    '''Parse out the subdomain from the request'''
    request.subdomain = None
    host = request.META.get('HTTP_HOST', '')
    host_s = host.replace('www.', '').split('.')
    if len(host_s) &gt; 2:
        request.subdomain = ''.join(host_s[:-2])</code></pre></li>
            <li><p>I added this to my project's <code>MIDDLEWARE_CLASSES</code>:</p><pre><code>MIDDLEWARE_CLASSES = (
    ...,
    'middleware.SubdomainMiddleware',
)</code></pre></li>
            <li><p>I edited my <code>/etc/hosts</code> file as per Dave's suggestion:</p><pre><code>127.0.0.1 test.com
127.0.0.1 blog.test.com
127.0.0.1 search.test.com</code></pre><p>Initially I replaced <code>test.com</code> with the site's domain name, but I decided that it's useful to be able to access both the live site and the test site without editing the <code>/etc/hosts</code> file.</p><p>At this point I expected everything to work as advertised. Instead, I got this:</p><p><img alt="It works!" src="/images/posts/windows/it-works!.png" />
</p><p>That would depend on one's definition of "works". I wanted my Django site to appear, which required a very simple tweak...</p></li>
            <li><p>I added the port number to the address:</p><pre><code>http://test.com:8000/</code></pre><p>This _actually_ worked. :)</p></li>
          </ol>
          <footer class="metadata">
            <ul>
              <li class="shorturl"><a href="http://dċd.ws/14/">Short URL</a></li>
            </ul>
            <h4>This post has the following tags:</h4>
            <ol>
              <li><a href="/tag/django/">Django</a></li>
              <li><a href="/tag/mac-os-x/">Mac OS X</a></li>
            </ol>
          </footer>
          <h3 id="related">Possibly related posts</h3>
          <ul>
            <li><a href="/django-syntax-highlighting-for-coda/">Django syntax highlighting for Coda</a></li>
            <li><a href="/empty-collections-are-valid-cache-data/">Empty collections are valid cache data</a></li>
            <li><a href="/show-full-directory-path-in-finder-window-title-bar/">Show full directory path in Finder window title bar</a></li>
            <li><a href="/changing-keyboard-shortcuts-in-mac-os-x/">Changing keyboard shortcuts in Mac OS X</a></li>
            <li><a href="/digitalcolor-meter/">DigitalColor Meter</a></li>
          </ul>
        </article>
      </div>
    </div>
    <footer>
      <p>Powered by <a href="http://mango.io/wtf?" data-version="0.9dev">Mango</a>. Hosted on <a href="http://www.linode.com/?r=ce523c9eeda64e4bceaf7011dc9e8558b909711d">Linode</a>. Original content <a href="/copying/">WTFPL-licensed</a>.</p>
    </footer>
  </body>
</html>
